Sub xoaDongTrong()
    Selection.WholeStory
    Selection.Find.ClearFormatting
    Selection.Find.Replacement.ClearFormatting
    For i = 1 To 3
    With Selection.Find
        .Text = "^p^p"
        .Replacement.Text = "^p"
        .Forward = True
        .Wrap = wdFindContinue
    End With
    Selection.Find.Execute Replace:=wdReplaceAll
    Selection.EscapeKey
    Selection.Find.ClearFormatting
    Selection.Find.Replacement.ClearFormatting
    With Selection.Find
        .Text = "^p^p^p"
        .Replacement.Text = "^p"
        .Forward = True
        .Wrap = wdFindContinue
    End With
        With Selection.Find
        .Text = "^p^p"
        .Replacement.Text = "^p"
        .Forward = True
        .Wrap = wdFindContinue
    End With
    Selection.Find.Execute Replace:=wdReplaceAll
    Selection.EscapeKey
    Selection.Find.ClearFormatting
    Selection.Find.Replacement.ClearFormatting
    With Selection.Find
        .Text = "^p^p"
        .Replacement.Text = "^p"
        .Forward = True
        .Wrap = wdFindContinue
    End With
    Next i
End Sub

Sub LayoutHNXFull()
'Thay font chu cua Bullet + Numbering (up to level 3)
    Dim par As Paragraph
    For Each par In ActiveDocument.ListParagraphs
        With par.Range.ListFormat.ListTemplate.ListLevels(1).Font
            .Name = "Arial"
            .Size = 10
        End With
         With par.Range.ListFormat.ListTemplate.ListLevels(2).Font
            .Name = "Arial"
            .Size = 10
        End With
         With par.Range.ListFormat.ListTemplate.ListLevels(3).Font
            .Name = "Arial"
            .Size = 10
        End With
    Next par

'Layout tong hop
    Selection.WholeStory
    Selection.Font.Name = "Arial"
    Selection.Font.Size = 10
    Selection.Range.Paragraphs.OutlineLevel = wdOutlineLevelBodyText

    With Selection.ParagraphFormat
        .FirstLineIndent = InchesToPoints(0)
        .LeftIndent = InchesToPoints(0)
        .CharacterUnitLeftIndent = 0
        .RightIndent = InchesToPoints(0)
        .CharacterUnitRightIndent = 0
        .SpaceBeforeAuto = False
        .SpaceAfterAuto = False
        .WordWrap = True
    End With
    With Selection.ParagraphFormat
        .SpaceBefore = 0
        .LineUnitBefore = 0
        .SpaceAfter = 6
        .LineUnitAfter = 0
    End With
    With Selection.ParagraphFormat
       .LineSpacing = LinesToPoints(1.5)
    End With

    With Selection.PageSetup
        .Orientation = wdOrientPortrait
    End With
    With Selection.PageSetup
        .TopMargin = InchesToPoints(1)
        .BottomMargin = InchesToPoints(1)
        .LeftMargin = InchesToPoints(1)
        .RightMargin = InchesToPoints(1)
    End With
    With Selection.PageSetup
        .PageWidth = InchesToPoints(8.27)
        .PageHeight = InchesToPoints(11.69)
    End With

'Xoa Bookmark
    Dim objBookmark As Bookmark, demSo As Integer
    demSo = 0
    For Each objBookmark In ActiveDocument.Bookmarks
        objBookmark.Delete
        demSo = demSo + 1
    Next 

'Xoa vbTab
    With Selection.Find
        .Text = vbTab
        .Replacement.Text = " "
        .Forward = True
        .Wrap = wdFindContinue
    End With
    Selection.Find.Execute Replace:=wdReplaceAll

'Dat tieu de
    On Error GoTo ErrorHandler
    Dim tenfile As String
    Dim farray1() As String
    Dim farray2() As String
    Dim dai As String
        Selection.HomeKey Unit:=wdStory
        tenfile = ActiveDocument.Name
        farray1 = Split(tenfile, "_")
        farray2 = Split(farray1(0), ".")
        dai = farray2(1) & ": " & Left(farray1(2), Len(farray1(2)) - 5)
        Selection.TypeText Text:=dai
        Selection.MoveStart wdLine, -1
        Selection.Font.Bold = True
        Selection.MoveStart wdCharacter, Len(dai)
        Selection.TypeParagraph
        Selection.TypeText Text:="Ng√†y "
        Selection.TypeParagraph
        Selection.MoveLeft Unit:=wdCharacter, Count:=1
    Exit Sub
ErrorHandler:
MsgBox "Dat lai ten file"
    Resume Next
End Sub

